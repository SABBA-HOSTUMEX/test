(function(){"use strict";var e={3653:function(e,n,i){var t=i(9242),o=i(3396);function a(e,n,i,t,a,r){const s=(0,o.up)("StorybrdWebView");return(0,o.wg)(),(0,o.j4)(s)}var r=i(7139);const s={key:0,class:"popups-div"},l={key:0,class:"popup-one popup-info"},c={class:"popup-one-container"},d={class:"popup-one-header"},u={class:"popup-one-content"},h={class:"popup-one-content"},p=["href","target"],f={key:1,class:"popup-one popup-minimap"},m=(0,o._)("div",{class:"popup-one-container"},[(0,o._)("iframe",{src:"minimap.html"})],-1),v={class:"storybrdWebView-page"},g={class:"page-top-ui"},w=(0,o._)("div",{class:"page-top-left"},[(0,o._)("a",{href:"index.html"},"回選單")],-1),C={class:"page-top-ui-center"},y={class:"page-main-title"},S={key:0,class:"page-scene-title"},k=(0,o._)("span",null,"可透過滑鼠拖曳控制視角",-1),x={class:"page-top-right"},_=(0,o.uE)('<svg fill="#000000" viewBox="0 0 32 32" version="1.1" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path d="M31.037 4.219l-10.030-4.158-9.982 3.951-10.062-3.949c-0.086-0.025-0.17-0.035-0.249-0.035-0.41-0.002-0.714 0.304-0.714 0.765v25.938c0 0.549 0.433 1.121 0.963 1.268l10.073 3.974 9.969-4.047 10.032 3.942c0.086 0.023 0.17 0.035 0.249 0.035 0.41 0 0.714-0.305 0.714-0.765v-25.648c0-0.549-0.433-1.122-0.963-1.27zM12 5.661l8-3.135v23.797l-8 3.162v-23.825zM2 2.709l8 2.956v23.805l-8-3.259v-23.502zM30 29.313l-8-3.012v-23.744l8 3.45v23.307z"></path></g></svg>',1),M=[_],b=(0,o.uE)('<svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><g id="SVGRepo_bgCarrier" stroke-width="0"></g><g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g><g id="SVGRepo_iconCarrier"><path fill-rule="evenodd" clip-rule="evenodd" d="M3 4C3 3.44772 3.44772 3 4 3H8C8.55228 3 9 3.44772 9 4C9 4.55228 8.55228 5 8 5H6.41421L9.70711 8.29289C10.0976 8.68342 10.0976 9.31658 9.70711 9.70711C9.31658 10.0976 8.68342 10.0976 8.29289 9.70711L5 6.41421V8C5 8.55228 4.55228 9 4 9C3.44772 9 3 8.55228 3 8V4ZM16 3H20C20.5523 3 21 3.44772 21 4V8C21 8.55228 20.5523 9 20 9C19.4477 9 19 8.55228 19 8V6.41421L15.7071 9.70711C15.3166 10.0976 14.6834 10.0976 14.2929 9.70711C13.9024 9.31658 13.9024 8.68342 14.2929 8.29289L17.5858 5H16C15.4477 5 15 4.55228 15 4C15 3.44772 15.4477 3 16 3ZM9.70711 14.2929C10.0976 14.6834 10.0976 15.3166 9.70711 15.7071L6.41421 19H8C8.55228 19 9 19.4477 9 20C9 20.5523 8.55228 21 8 21H4C3.44772 21 3 20.5523 3 20V16C3 15.4477 3.44772 15 4 15C4.55228 15 5 15.4477 5 16V17.5858L8.29289 14.2929C8.68342 13.9024 9.31658 13.9024 9.70711 14.2929ZM14.2929 14.2929C14.6834 13.9024 15.3166 13.9024 15.7071 14.2929L19 17.5858V16C19 15.4477 19.4477 15 20 15C20.5523 15 21 15.4477 21 16V20C21 20.5523 20.5523 21 20 21H16C15.4477 21 15 20.5523 15 20C15 19.4477 15.4477 19 16 19H17.5858L14.2929 15.7071C13.9024 15.3166 13.9024 14.6834 14.2929 14.2929Z" fill="#000000"></path></g></svg>',1),B=[b],D={key:0,class:"door-links-div"},z=["href"],P=["href"],V=["href"],A=["href"],L={key:1,class:"ScCutMenu"},O={class:"ScCutMenu-sc-ul"},I=["onClick"],j=(0,o._)("span",null,"前往",-1),E=(0,o._)("br",null,null,-1),T=(0,o._)("a",{class:"ScCutMenu-Replay-btn"},[(0,o.Uk)("重新"),(0,o._)("br"),(0,o.Uk)("播放")],-1),N=[T],R={class:"hide",ref:"VoAudioEle",id:"VoAudioEle"};function F(e,n,i,t,a,_){return(0,o.wg)(),(0,o.iD)(o.HY,null,[a.OnPopup&&""!=a.OnPopup?((0,o.wg)(),(0,o.iD)("div",s,["Info"==a.OnPopup?((0,o.wg)(),(0,o.iD)("div",l,[(0,o._)("a",{class:"popup-close-btn",onClick:n[0]||(n[0]=e=>_.closePopups())}),(0,o._)("div",c,[(0,o._)("div",d,(0,r.zw)(a.PopupData.m_title),1),(0,o._)("div",u,(0,r.zw)(a.PopupData.m_desc),1),(0,o._)("div",h,[(0,o._)("a",{href:a.PopupData.m_link,target:1==a.PopupData.extlink?"_blank":"_self"},(0,r.zw)(a.PopupData.m_link),9,p)])])])):(0,o.kq)("",!0),"Minimap"==a.OnPopup?((0,o.wg)(),(0,o.iD)("div",f,[(0,o._)("a",{class:"popup-close-btn",onClick:n[1]||(n[1]=e=>_.closePopups())}),m])):(0,o.kq)("",!0)])):(0,o.kq)("",!0),(0,o._)("div",v,[(0,o._)("div",g,[w,(0,o._)("div",C,[(0,o._)("div",y,[a.currentSc?((0,o.wg)(),(0,o.iD)("h3",S,(0,r.zw)(a.currentSc.m_name),1)):(0,o.kq)("",!0),k])]),(0,o._)("div",x,[(0,o._)("a",{onClick:n[2]||(n[2]=(...e)=>_.ClickViewMinimap&&_.ClickViewMinimap(...e))},M),(0,o._)("a",{onClick:n[3]||(n[3]=(...e)=>_.ClickViewFullScreen&&_.ClickViewFullScreen(...e))},B)])]),(0,o._)("canvas",{id:"viewspace",onMousedown:n[4]||(n[4]=(...e)=>_.viewspaceOnDown&&_.viewspaceOnDown(...e))},null,32),a.currentSc&&a.currentSc.doorLinks?((0,o.wg)(),(0,o.iD)("div",D,[a.currentSc.doorLinks["top"]?((0,o.wg)(),(0,o.iD)("a",{key:0,href:a.currentSc.doorLinks["top"],class:"door-link-a door-link-a-top"},null,8,z)):(0,o.kq)("",!0),a.currentSc.doorLinks["left"]?((0,o.wg)(),(0,o.iD)("a",{key:1,href:a.currentSc.doorLinks["left"],class:"door-link-a door-link-a-left"},null,8,P)):(0,o.kq)("",!0),a.currentSc.doorLinks["right"]?((0,o.wg)(),(0,o.iD)("a",{key:2,href:a.currentSc.doorLinks["right"],class:"door-link-a door-link-a-right"},null,8,V)):(0,o.kq)("",!0),a.currentSc.doorLinks["down"]?((0,o.wg)(),(0,o.iD)("a",{key:3,href:a.currentSc.doorLinks["down"],class:"door-link-a door-link-a-down"},null,8,A)):(0,o.kq)("",!0)])):(0,o.kq)("",!0),a.AllScene.length>0?((0,o.wg)(),(0,o.iD)("div",L,[(0,o._)("ul",O,[((0,o.wg)(!0),(0,o.iD)(o.HY,null,(0,o.Ko)(a.AllScene,((e,n)=>((0,o.wg)(),(0,o.iD)("li",{class:(0,r.C_)(n==a.currentScId?"active":"")},[(0,o._)("div",{onClick:e=>_.ClickViewScene(n),class:"ScCutMenu-btn",style:(0,r.j5)("")},[j,(0,o._)("strong",null,(0,r.zw)(e.m_name),1)],12,I)],2)))),256)),(0,o._)("li",{onClick:n[5]||(n[5]=e=>_.ClickPlaySwitch())},[(0,o._)("a",{class:(0,r.C_)(["ScCutMenu-Play-btn",1==a.autoNext?"active":""])},[(0,o.Uk)("自動"),E,(0,o.Uk)("播放")],2)]),(0,o._)("li",{onClick:n[6]||(n[6]=e=>_.ClickReplayStory())},N)])])):(0,o.kq)("",!0)]),(0,o._)("audio",R,null,512)],64)}i(7658);var q=i(1114),H=i(7893),U=i(4543),Y=i(4198),W=i(6573),Z=i(7393),G=i(4311),X={data(){return{}},filters:{},methods:{}};const $=X;var K,Q,J,ee,ne,ie,te,oe,ae,re,se,le=$,ce={mixins:[le],name:"storybrdWebView",data(){return{storydata:null,currentScId:-1,currentSc:null,AllScene:[],CamxSpeed:.1,CamySpeed:.1,allvideo:[],autoNext:!1,autoTimer:null,AnimationClips:[],AniMixers:[],dataName:"storydata.json",pageLocation:window.location.hash,OnPopup:"",PopupData:null,doorLinks:{},MinimapSc:null,infullscreen:!1}},watch:{},mounted(){var e=this;window.addEventListener("hashchange",(function(){window.location.hash&&e.SetCurrByHash(window.location.hash)}),!1),this.init()},setup(){},methods:{init(){this.threejs_Init()},threejs_Init:function(){this.scene_build(),this.render_animate(),te=(new Y.E).setPath("./data/"),this.viewer_init()},ClickViewCamera:function(e){se=e,re.camera=e,this.camcontrols_set(e)},camcontrols_set:function(e,n){oe?oe.object=e:(oe=new U.z(e,K),oe.addEventListener("change",(function(){}))),n.n_type&&"Minimap"==n.n_type?(oe.target.set(n.Center.x-.8,n.Center.y-6,n.Center.z),e.position.x=e.position.x,e.position.y=e.position.y,e.position.z=e.position.z+5):oe.target.set(e.position.x,e.position.y,e.position.z-.01),oe.update(),ae?(ae.scene=re,ae.camera=se):ae=new H.U4(ee,re,se),console.log(e.position,e.rotation)},viewer_init:function(){this.loadStoryData()},loadStoryData:function(){return G.Z.get("./"+this.dataName).then((e=>{this.StoryDataOnLoad(e.data)})),{}},StoryDataOnLoad:function(e){var n=this;if(this.storydata=e,e.cuts){var i,t;for(var o in e.cuts)i=e.cuts[o],""!=i.m_filename&&(t=this.InitStoryCut(i),this.AllScene.push(t),i.n_type&&"Minimap"==i.n_type&&(n.MinimapSc=o));window.location.hash?n.SetCurrByHash(window.location.hash):n.SetCurrScene(0)}},SetCurrByHash:function(e){var n=this,i=e;if("#"==i.substr(0,1)&&(i=i.substr(1)),"s"==i.substr(0,1)){var t=parseInt(i.substr(1));this.AllScene[t]&&n.SetCurrScene(t)}},ClickPlaySwitch:function(){var e=this;this.autoNext=!this.autoNext,1==this.autoNext&&(this.ResetTimer(),this.autoTimer=setTimeout((function(){1==e.autoNext&&e.autoNextCut()}),1e3*parseInt(this.currentSc.m_time)))},ClickReplayStory:function(){this.autoNext=!0,window.location.hash="s0"},ClickViewScene:function(e){window.location.hash="s"+e},viewspaceOnDown:function(){this.autoNext=!1},SetCurrScene:function(e){var n=this;this.stop_allvideo(),this.stop_allsound(),this.AllScene[e]&&(this.currentScId=e,this.currentSc=this.AllScene[e],this.currentSc.loaded||this.LoadStoryCutSc(this.currentSc),this.autoNext&&this.currentSc.m_time&&(this.ResetTimer(),this.autoTimer=setTimeout((function(){1==n.autoNext&&n.autoNextCut()}),1e3*parseInt(this.currentSc.m_time))))},autoNextCut:function(){var e=this.currentScId+1;this.AllScene[e]&&this.SetCurrScene(e)},ResetTimer:function(){this.autoTimer&&clearTimeout(this.autoTimer)},InitStoryCut:function(e){return e.inited=!0,e.loaded=!1,e},LoadStoryCutSc:function(e){var n=this,i=new q.xsS;n.firstStageLoaded(i,e)},SetBaseCamera:function(){var e=new q.cPb(30,window.innerWidth/window.innerHeight,.1,20);e.position.set(0,1,5),se=e,re.camera=e;const n=new U.z(e,K);n.screenSpacePanning=!0,n.target.set(0,1,0),n.update();const i=new q.Ox3(16777215);i.position.set(1,1,1).normalize(),re.add(i)},DefChar:null,loadDummyData:function(){var e=this;const n=new Y.E;n.crossOrigin="anonymous",n.register((e=>new Z.XX(e))),n.load("https://rawcdn.githack.com/pixiv/three-vrm/63e9e5d48e317b3ab079c31e0d84e3ee02ada2d7/examples/models/three-vrm-girl.vrm",(n=>{const i=n.userData.vrm;Q.add(i.scene),e.DefChar=i.scene,console.log(i)}),(e=>console.log("Loading model...",e.loaded/e.total*100,"%")),(e=>console.error(e)))},tryLoadGltfAni:function(e){var n=this;te.load("test_ed.gltf",(function(i){if(i.animations&&i.animations.length>0){var t=i.animations;for(var o in t){var a=t[o];n.AnimationClips.push(a)}e()}}))},tryLoadMixAni:function(){var e=this,n=new W.y;n.load("data/Ch28_nonPBR@RumbaDancing.fbx",(function(n){n.scale.set(.01,.01,.01);var i=n.animations,t=i[0];console.log(t),e.AnimationClips.push(t),e.newAnimationClipPlay(e.DefChar,t)}),(e=>{console.log(e.loaded/e.total*100+"% loaded")}),(e=>{console.log(e)}))},newAnimationClipPlay:function(e,n){var i=new q.Xcj(e);i.timeScale=1,this.AniMixers.push(i);var t=i.clipAction(n);t.play()},firstStageLoaded:function(e,n){var i=this;te.load(n.m_filename,(function(t){if(console.log(t),i.ScModelOnLoad(t,e,n),n.cameras.length>0){var o=n.cameras[0];se=o,i.camcontrols_set(o,n)}})),re=e,n["Scene"]=e},ScModelOnLoad:function(e,n,i){var t=this;if(!e||!e.scene)return!1;var o=e.scene;if(o&&o.children&&o.children.length>0){if(o.meshslist=[],o.voaudios=[],e.animations&&e.animations.length>0){var a=e.animations;for(var r in a){var s=a[r];t.AnimationClips.push(s)}}o.center=new q.FM8(0,0);var l={x1:1e5,x2:-1e4,y1:1e4,y2:-1e4,z1:1e4,z2:-1e4};i["modelsc"]=o,i["animsMap"]={},i["audiosMap"]={},i["videosMap"]={},i["linksMap"]={},i["infosMap"]={};var c,d,u,h,p,f="";if(i.anims.length>0)for(var m in i.anims)c=i.anims[m],f=c["m_name"].replace(" ","_"),i["animsMap"][f]=c["anim_name"];if(i.audios.length>0)for(var m in i.audios)d=i.audios[m],f=d["m_name"].replace(" ","_"),i["audiosMap"][f]={audio_url:d["audio_url"]};if(i.videos.length>0)for(var m in i.videos)u=i.videos[m],f=u["m_name"].replace(" ","_"),i["videosMap"][f]={video_url:u["video_url"]};if(i.infos.length>0)for(var m in i.infos)h=i.infos[m],f=h["m_name"].replace(" ","_"),i["infosMap"][f]=h;if(i.links.length>0)for(var m in i.links)p=i.links[m],f=p["m_name"].replace(" ","_"),i["linksMap"][f]={url:p["link_url"]};var v=t.findModelDatas(o,[],[],l,i);i["cameras"]=v[0],i["lights"]=v[1],i["BoundingBox"]=v[2],i["Center"]={x:(i["BoundingBox"].x1+i["BoundingBox"].x2)/2,y:(i["BoundingBox"].y1+i["BoundingBox"].y2)/2,z:(i["BoundingBox"].z1+i["BoundingBox"].z2)/2},i["xdist"]=t.twoPointDistance(i["BoundingBox"].x1,i["BoundingBox"].x2),i["ydist"]=t.twoPointDistance(i["BoundingBox"].y1,i["BoundingBox"].y2),i["zdist"]=t.twoPointDistance(i["BoundingBox"].z1,i["BoundingBox"].z2),i["dist"]=Math.max(Math.max(i["xdist"],i["ydist"]),i["zdist"]),console.log(i),1==i["modelsc"].voaudios.length&&setTimeout((function(){t.playVoSound(i["modelsc"].voaudios[0].audio)}),2e3),t.createNewLighting(o),n.add(o)}},modelscOnLoaded:function(){},findMeshByName:function(){},twoPointDistance:function(e,n){let i=Math.sqrt(Math.pow(e-n,2));return i},createNewLighting:function(e){var n=new q.vmT(11184810,0,.9),i=new q.Mig(16777215,.5),t=new q.Ox3(16777215,1);t.position.set(5,20,-5),t.castShadow=!0,t.shadowCameraVisible=!0,t.shadowDarkness=.5,t.shadow.camera.left=-500,t.shadow.camera.right=500,t.shadow.camera.top=500,t.shadow.camera.bottom=-500,t.shadow.camera.near=1,t.shadow.camera.far=1e3,t.shadowCameraVisible=!0,t.shadow.mapSize.width=4096,t.shadow.mapSize.height=4096,e.add(n),e.add(i),e.add(t)},getCenterPoint:function(e){var n=e.geometry;n.computeBoundingBox();var i=new q.Pa4;return n.boundingBox.getCenter(i),e.localToWorld(i),i},findModelDatas:function(e,n,i,t,o){var a,r=this;if(e&&e.children&&e.children.length>0)for(var s in e.children){if(a=e.children[s],a.isLight&&(i.push(a),a.visible=!1),a.isCamera){var l=new q.cPb(a.fov,ie.width/ie.height,.01,a.far);l.position.set(a.position.x,a.position.y,a.position.z);var c=new q.USm;c.setFromQuaternion(a.quaternion),c.y+=Math.PI,c.z*=-1,l.rotation.copy(c),l.baseRotation=c,n.push(l)}a.isCamera||a.isLight||(t.x1=Math.min(t.x1,a.position.x),t.x2=Math.max(t.x2,a.position.x),t.y1=Math.min(t.y1,a.position.y),t.y2=Math.max(t.y2,a.position.y),t.z1=Math.min(t.z1,a.position.z),t.z2=Math.max(t.z1,a.position.z));var d=r.findModelDatas(a,n,i,t,o);n=d[0],i=d[1],t=d[2],o=d[3]}return r.detectIfhavBindings(o,e),[n,i,t,o]},detectIfhavBindings:function(e,n){var i=this;i.detectIfhavAnimsBinding(e,n),i.detectIfhavVideoBinding(e,n),i.detectIfhavAudioBinding(e,n),i.detectIfhavLinkBinding(e,n),i.detectIfhavInfoBinding(e,n)},detectIfhavVideoBinding:function(e,n){var i=this;if(e["videosMap"]&&e["videosMap"][n.name]){var t,o=e["videosMap"][n.name];if("Mesh"==n.type)t=n;else if(n.children.length>0)for(var a in n.children)n.children[a]&&"Mesh"==n.children[a].type&&(t=n.children[a]);if(t){var r=i.genVideoTexture("data/"+o.video_url,1920,1080);const e=new q.jyz({uniforms:{map:{value:r},keyColor:{value:[0,1,0]},similarity:{value:.1},smoothness:{value:0}},vertexShader:i.vertexShader(),fragmentShader:i.fragmentShader()});r.needsUpdate=!0,t.material=e}}},detectIfhavAudioBinding:function(e,n){var i=this;if(e["audiosMap"]&&e["audiosMap"][n.name]){var t,o=e["audiosMap"][n.name];if("Object3D"==n.type)t=n;else if(n.children.length>0)for(var a in n.children)n.children[a]&&"Object3D"==n.children[a].type&&(t=n.children[a]);t&&(t.audio=o.audio_url,i.genOneSprite("images/icon-audio.png",t,(function(e,n){e.position.set(0,2,0),n.add(e),e.cursor="pointer",e.on("click",(function(){i.playVoSound(n.audio)}))})),e["modelsc"].voaudios.push(t))}},detectIfhavLinkBinding:function(e,n){var i=this;if(e["linksMap"]&&e["linksMap"][n.name]&&!e["infosMap"][n.name]){var t,o=e["linksMap"][n.name];if("Object3D"==n.type)t=n;else if(n.children.length>0)for(var a in n.children)n.children[a]&&"Object3D"==n.children[a].type&&(t=n.children[a]);if(t){t.url=o.url;var r=(t.url.match(/,/g)||[]).length;if(3==r){var s,l=t.url.split(","),c=["top","left","right","down"];i.currentSc.doorLinks={};for(var d=0;d<4;d++)s=l[d],""!=s&&(i.currentSc.doorLinks[c[d]]=s)}else i.genOneSprite("images/icon-link.png",t,(function(e,n){e.position.set(0,2,0),n.add(e),e.cursor="pointer",e.on("click",(function(){top.location.href=n.url}))})),e["modelsc"].voaudios.push(t)}}},detectIfhavInfoBinding:function(e,n){var i=this;if(e["infosMap"]&&e["infosMap"][n.name]){var t,o=e["infosMap"][n.name];if("Object3D"==n.type)t=n;else if(n.children.length>0)for(var a in n.children)n.children[a]&&"Object3D"==n.children[a].type&&(t=n.children[a]);t&&(t.cursor="pointer",t.info=o,t.on("click",(function(){i.openPopupInfo(t.info)})))}},openPopupInfo:function(e){this.OnPopup="Info",this.PopupData=e},closePopups:function(){this.OnPopup="",this.PopupData=null},detectIfhavAnimsBinding:function(e,n){var i=this;if(e["animsMap"]&&e["animsMap"][n.name]){var t=new q.Xcj(n);for(var o in t.timeScale=1,i.AniMixers.push(t),i.AnimationClips){var a=i.AnimationClips[o];if(a.name==e["animsMap"][n.name]){var r=t.clipAction(a);r.play()}}n.AnimationMixer=t}},playVoSound:function(e){this.$refs.VoAudioEle&&(this.$refs.VoAudioEle.src="data/"+e,this.$refs.VoAudioEle.play())},stopVoSound:function(){this.$refs.VoAudioEle&&(this.$refs.VoAudioEle.src="")},genOneSprite(e,n,i){var t=this;(new q.dpR).load(e,(function(e){var o=e.image,a=t.getTileScaleByImg(o),r=new q.xeV({map:e}),s=new q.jyi(r);s.scale.set(a.x/3,a.y/3,1),s.center=new q.FM8(.5,.5),i(s,n)}))},getTileScaleByImg:function(e,n,i,t){var o,a,r=1.8;if(t&&(r=t),o=n?n/100:e.width/100,a=i?i/100:e.height/100,o>r||a>r){var s=r/o,l=r/a,c=Math.min(s,l);o*=c,a*=c}return{x:o,y:a}},vertexShader(){return"\n                varying vec2 vUv;\n                void main( void ) {     \n                    vUv = uv;\n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0);\n                }\n            "},fragmentShader(){return"\n                uniform vec3 keyColor;\n                uniform float similarity;\n                uniform float smoothness;\n                varying vec2 vUv;\n                uniform sampler2D map;\n                void main() {\n\n                    vec4 videoColor = texture2D(map, vUv);\n            \n                    float Y1 = 0.299 * keyColor.r + 0.587 * keyColor.g + 0.114 * keyColor.b;\n                    float Cr1 = keyColor.r - Y1;\n                    float Cb1 = keyColor.b - Y1;\n                    \n                    float Y2 = 0.299 * videoColor.r + 0.587 * videoColor.g + 0.114 * videoColor.b;\n                    float Cr2 = videoColor.r - Y2; \n                    float Cb2 = videoColor.b - Y2; \n                    \n                    float blend = smoothstep(similarity, similarity + smoothness, distance(vec2(Cr2, Cb2), vec2(Cr1, Cb1)));\n                    gl_FragColor = vec4(videoColor.rgb, videoColor.a * blend); \n                }\n            "},genVideoTexture(e,n,i){var t=document.getElementById("app"),o=document.createElement("div");o.className="video-texture-div";var a=document.createElement("video");a.width=n,a.height=i,a.className="video-texture",a.src=e,a.autoplay=!1,a.loop=!1,a.volume=.18,a.onloadeddata=function(){},a.oncanplay=function(){a.play()},this.allvideo.push(a);var r=new q.fO1(a);return r.needsUpdate=!0,r.flipX=!0,r.flipY=!1,t.appendChild(o),o.appendChild(a),r},scene_build:function(){ne=new q.SUY,K=document.querySelector("#viewspace"),ee=new q.CP7({canvas:K,antialias:!0}),ie={width:window.innerWidth,height:window.innerHeight},window.addEventListener("resize",this.on_resize,!1),document.addEventListener("keydown",this.onDocumentKeyDown,!1),re=this.defScenecamera_build(),ee.setPixelRatio(window.devicePixelRatio),ee.setSize(window.innerWidth,window.innerHeight),ee.shadowMapEnabled=!0,ee.shadowMapSoft=!0,ee.shadowMapType=q.ntZ,ee.setClearColor(3355443,1)},defScenecamera_build:function(){return Q=new q.xsS,Q.background=new q.Ilk("#AAA"),J=new q.cPb(60,ie.width/ie.height,.1,10001),J.position.set(0,0,10),Q.camera=J,se=J,Q},on_resize:function(){var e={width:window.innerWidth,height:window.innerHeight};J.aspect=e.width/e.height,J.updateProjectionMatrix(),ee.setSize(e.width,e.height)},render_animate:function(){if(ee.render(re,se),this.AniMixers.length>0){const n=ne.getDelta();for(var e in this.AniMixers)this.AniMixers[e].update(n)}requestAnimationFrame(this.render_animate)},stop_allvideo:function(){this.removeElementsByClass("video-texture-div")},stop_allsound:function(){this.stopVoSound()},removeElementsByClass(e){const n=document.getElementsByClassName(e);while(n.length>0)n[0].parentNode.removeChild(n[0])},onDocumentKeyDown:function(e){var n,i,t=e.which,o={front:[["z",-1],["z",1],["x",-1],["x",1]],right:[["x",-1],["x",1],["z",-1],["z",1]],back:[["z",1],["z",-1],["x",1],["x",-1]],left:[["x",1],["x",-1],["z",-1],["z",1]]};if(oe){var a=oe.getAzimuthalAngle();n=a>-.6&&a<=.6?o["front"]:a>.6&&a<=2?o["right"]:a>2||a<-2?o["back"]:o["left"];var r=-1;87==t||38==t?se&&(r=0):83==t||40==t?se&&(r=1):65==t||37==t?se&&(r=2):68!=t&&39!=t||se&&(r=3),-1!=r&&(r=r>3?r-3:r,i=n[r],se.position[i[0]]+=this.CamySpeed*i[1])}},ClickViewMinimap:function(){this.MinimapSc?this.SetCurrScene(this.MinimapSc):this.OnPopup="Minimap"},ClickViewFullScreen:function(){var e=document.getElementById("app");this.infullscreen?(this.infullscreen=!1,document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()):(this.infullscreen=!0,e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.msRequestFullscreen&&e.msRequestFullscreen())}}},de=i(89);const ue=(0,de.Z)(ce,[["render",F]]);var he=ue,pe={name:"App",components:{StorybrdWebView:he}};const fe=(0,de.Z)(pe,[["render",a]]);var me=fe;(0,t.ri)(me).mount("#app")}},n={};function i(t){var o=n[t];if(void 0!==o)return o.exports;var a=n[t]={exports:{}};return e[t](a,a.exports,i),a.exports}i.m=e,function(){var e=[];i.O=function(n,t,o,a){if(!t){var r=1/0;for(d=0;d<e.length;d++){t=e[d][0],o=e[d][1],a=e[d][2];for(var s=!0,l=0;l<t.length;l++)(!1&a||r>=a)&&Object.keys(i.O).every((function(e){return i.O[e](t[l])}))?t.splice(l--,1):(s=!1,a<r&&(r=a));if(s){e.splice(d--,1);var c=o();void 0!==c&&(n=c)}}return n}a=a||0;for(var d=e.length;d>0&&e[d-1][2]>a;d--)e[d]=e[d-1];e[d]=[t,o,a]}}(),function(){i.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(n,{a:n}),n}}(),function(){i.d=function(e,n){for(var t in n)i.o(n,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})}}(),function(){i.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){i.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={143:0};i.O.j=function(n){return 0===e[n]};var n=function(n,t){var o,a,r=t[0],s=t[1],l=t[2],c=0;if(r.some((function(n){return 0!==e[n]}))){for(o in s)i.o(s,o)&&(i.m[o]=s[o]);if(l)var d=l(i)}for(n&&n(t);c<r.length;c++)a=r[c],i.o(e,a)&&e[a]&&e[a][0](),e[a]=0;return i.O(d)},t=self["webpackChunkstoryboard_studio_html"]=self["webpackChunkstoryboard_studio_html"]||[];t.forEach(n.bind(null,0)),t.push=n.bind(null,t.push.bind(t))}();var t=i.O(void 0,[998],(function(){return i(3653)}));t=i.O(t)})();
//# sourceMappingURL=app.js.map